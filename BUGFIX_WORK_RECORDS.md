# ê·¼ë¬´ ê¸°ë¡ ì €ì¥ ë¬¸ì œ ìˆ˜ì • ì‚¬í•­

**ìˆ˜ì • ë‚ ì§œ**: 2025-10-17  
**ë¬¸ì œ**: ë°°í¬ëœ ì‚¬ì´íŠ¸ì—ì„œ ì§ì›ë“¤ì˜ ê·¼ë¬´ ê¸°ë¡ì´ ì •ìƒì ìœ¼ë¡œ ì €ì¥ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ

---

## ğŸ”§ ìˆ˜ì • ë‚´ìš©

### 1. ì‹œê°„ í˜•ì‹ í‘œì¤€í™” (ê°€ì¥ ì¤‘ìš”)

**ë¬¸ì œì **:
- `toLocaleTimeString('ko-KR')`ì€ í™˜ê²½ì— ë”°ë¼ ë‹¤ë¥¸ í˜•ì‹ì„ ë°˜í™˜
- Vercel ì„œë²„ë¦¬ìŠ¤ í™˜ê²½ì—ì„œ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ì‹œê°„ í˜•ì‹ ìƒì„±
- ì‹œê°„ íŒŒì‹± ì˜¤ë¥˜ë¡œ ì¸í•œ ê·¼ë¬´ ì‹œê°„ ê³„ì‚° ì‹¤íŒ¨

**ìˆ˜ì • ì‚¬í•­**:
```javascript
// ì´ì „ (ë¬¸ì œ ìˆìŒ)
const time = new Date().toLocaleTimeString('ko-KR', { hour12: false, timeZone: 'Asia/Seoul' });

// ìˆ˜ì • í›„ (ì•ˆì •ì )
const getCurrentTimeKST = () => {
  const now = new Date();
  const kstDate = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Seoul' }));
  const hours = String(kstDate.getHours()).padStart(2, '0');
  const minutes = String(kstDate.getMinutes()).padStart(2, '0');
  const seconds = String(kstDate.getSeconds()).padStart(2, '0');
  return `${hours}:${minutes}:${seconds}`; // í•­ìƒ HH:mm:ss í˜•ì‹
};
```

**ì˜í–¥**:
- âœ… ëª¨ë“  í™˜ê²½ì—ì„œ ì¼ê´€ëœ ì‹œê°„ í˜•ì‹ ë³´ì¥
- âœ… ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì•ˆì •ì„± í–¥ìƒ
- âœ… ê·¼ë¬´ ì‹œê°„ ê³„ì‚° ì •í™•ë„ ê°œì„ 

---

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í’€ ìµœì í™”

**ë¬¸ì œì **:
- `max: 1` ì„¤ì •ìœ¼ë¡œ ë™ì‹œ ì ‘ì† ì²˜ë¦¬ ë¶ˆê°€
- ì—¬ëŸ¬ ì§ì›ì´ ë™ì‹œì— ì¶œí‡´ê·¼ ì²˜ë¦¬ ì‹œ ì—°ê²° ëŒ€ê¸°/íƒ€ì„ì•„ì›ƒ ë°œìƒ

**ìˆ˜ì • ì‚¬í•­**:
```javascript
// ì´ì „
max: 1, // ë™ì‹œ ì—°ê²° 1ê°œë§Œ í—ˆìš©

// ìˆ˜ì • í›„
max: 3, // ë™ì‹œ ì—°ê²° 3ê°œ í—ˆìš© (ì„œë²„ë¦¬ìŠ¤ í™˜ê²½ ìµœì í™”)
```

**ì¶”ê°€**:
```javascript
// ì—°ê²° í’€ ì—ëŸ¬ ë¡œê¹… ì¶”ê°€
pool.on('error', (err) => {
  console.error('Unexpected database pool error:', err);
});
```

**ì˜í–¥**:
- âœ… ë™ì‹œ ì ‘ì† ì²˜ë¦¬ ëŠ¥ë ¥ í–¥ìƒ
- âœ… ì¶œí‡´ê·¼ ì²˜ë¦¬ ì†ë„ ê°œì„ 
- âœ… íƒ€ì„ì•„ì›ƒ ì˜¤ë¥˜ ê°ì†Œ

---

### 3. ì—ëŸ¬ ë¡œê¹… ê°•í™”

**ì¶”ê°€ëœ ë¡œê·¸**:

**ì¶œê·¼ ì²˜ë¦¬ (`/api/clock-in`)**:
```javascript
console.log(`Clock in attempt - userId: ${userId}, date: ${date}, time: ${time}`);
console.log(`Clock in success - shiftId: ${result.rows[0].id}, userId: ${userId}`);
console.log(`Clock in failed - already clocked in: userId ${userId}`);
```

**í‡´ê·¼ ì²˜ë¦¬ (`/api/clock-out`)**:
```javascript
console.log(`Clock out attempt - userId: ${userId}, date: ${date}, time: ${time}`);
console.log(`Found active shift - shiftId: ${shift.id}, start_time: ${shift.start_time}`);
console.log(`Calculated work hours: ${workHours}`);
console.log(`Clock out success - shiftId: ${shift.id}, userId: ${userId}, workHours: ${workHours}`);
```

**ì˜í–¥**:
- âœ… Vercel ë¡œê·¸ì—ì„œ ë¬¸ì œ ì¶”ì  ê°€ëŠ¥
- âœ… ì‹¤ì‹œê°„ ë””ë²„ê¹… ì •ë³´ ì œê³µ
- âœ… í–¥í›„ ë¬¸ì œ ë°œìƒ ì‹œ ë¹ ë¥¸ ì›ì¸ íŒŒì•…

---

### 4. ê·¼ë¬´ ì‹œê°„ ê³„ì‚° ë¡œì§ ê°œì„ 

**ì¶”ê°€ëœ ì•ˆì „ì¥ì¹˜**:

```javascript
function calculateWorkHours(startTime, endTime) {
  try {
    // ì‹œê°„ íŒŒì‹± ê²€ì¦
    if (isNaN(startHour) || isNaN(startMin) || isNaN(endHour) || isNaN(endMin)) {
      console.error(`Invalid time format - start: ${startTime}, end: ${endTime}`);
      return 0;
    }
    
    // ì•¼ê°„ ê·¼ë¬´ ì²˜ë¦¬ (ìì • ë„˜ì–´ê°€ëŠ” ê²½ìš°)
    if (diffMinutes < 0) {
      diffMinutes += 24 * 60;
    }
    
    // ... íœ´ê²Œì‹œê°„ ê³„ì‚°
  } catch (error) {
    console.error('Error calculating work hours:', error);
    return 0;
  }
}
```

**ì˜í–¥**:
- âœ… ì˜ëª»ëœ ì‹œê°„ í˜•ì‹ ì²˜ë¦¬
- âœ… ì•¼ê°„ ê·¼ë¬´ ì§€ì›
- âœ… ì—ëŸ¬ ë°œìƒ ì‹œ 0 ë°˜í™˜ (ì•± í¬ë˜ì‹œ ë°©ì§€)

---

### 5. í”„ë¡ íŠ¸ì—”ë“œ ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ 

**ì¶”ê°€ëœ ê¸°ëŠ¥**:

```javascript
// ìƒì„¸í•œ ì—ëŸ¬ ë¡œê¹…
console.log('Clock in request - userId:', user.id);
console.log('Clock in response:', response.data);
console.error('Clock in error:', error);
console.error('Error response:', error.response?.data);

// ì‚¬ìš©ì ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€
const errorMsg = error.response?.data?.message || 
                 'ì¶œê·¼ ì²˜ë¦¬ ì‹¤íŒ¨: ' + (error.message || 'ì„œë²„ ì˜¤ë¥˜');
setMessage(errorMsg);
setTimeout(() => setMessage(''), 5000); // 5ì´ˆë¡œ ì—°ì¥
```

**ì˜í–¥**:
- âœ… ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ë¬¸ì œ í™•ì¸ ê°€ëŠ¥
- âœ… ì‚¬ìš©ìì—ê²Œ ëª…í™•í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ ì œê³µ
- âœ… ë””ë²„ê¹… ì •ë³´ ìˆ˜ì§‘ ìš©ì´

---

## ğŸ“‹ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°°í¬ ì „ í™•ì¸ì‚¬í•­

- [x] API ì„œë²„ ì½”ë“œ ìˆ˜ì • ì™„ë£Œ
- [x] í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œ ìˆ˜ì • ì™„ë£Œ
- [ ] ë¡œì»¬ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸
- [ ] Vercelì— ë°°í¬
- [ ] ë°°í¬ í›„ ì‹¤ì œ ì¶œí‡´ê·¼ í…ŒìŠ¤íŠ¸

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

1. **ë‹¨ì¼ ì‚¬ìš©ì ì¶œí‡´ê·¼**
   - [ ] ì¶œê·¼ ì²˜ë¦¬ ì •ìƒ ì‘ë™
   - [ ] í‡´ê·¼ ì²˜ë¦¬ ì •ìƒ ì‘ë™
   - [ ] ê·¼ë¬´ ì‹œê°„ ì •í™•íˆ ê³„ì‚°
   - [ ] ë°ì´í„°ë² ì´ìŠ¤ì— ì •ìƒ ì €ì¥

2. **ë™ì‹œ ë‹¤ì¤‘ ì‚¬ìš©ì**
   - [ ] 2-3ëª… ë™ì‹œ ì¶œê·¼ ì²˜ë¦¬
   - [ ] ëª¨ë“  ê¸°ë¡ ì •ìƒ ì €ì¥
   - [ ] íƒ€ì„ì•„ì›ƒ ì˜¤ë¥˜ ì—†ìŒ

3. **ì—£ì§€ ì¼€ì´ìŠ¤**
   - [ ] ì¤‘ë³µ ì¶œê·¼ ì‹œë„ ì°¨ë‹¨
   - [ ] ì¶œê·¼ ê¸°ë¡ ì—†ì´ í‡´ê·¼ ì‹œë„ ì°¨ë‹¨
   - [ ] íœ´ê²Œì‹œê°„ í¬í•¨ ê·¼ë¬´ ì‹œê°„ ê³„ì‚°
   - [ ] ì•¼ê°„ ê·¼ë¬´ (ìì • ë„˜ì–´ê°€ëŠ” ê²½ìš°)

---

## ğŸ” ëª¨ë‹ˆí„°ë§ ë°©ë²•

### Vercel ë¡œê·¸ í™•ì¸

1. Vercel ëŒ€ì‹œë³´ë“œ ì ‘ì†
2. í”„ë¡œì íŠ¸ ì„ íƒ
3. **Functions** íƒ­ í´ë¦­
4. `/api` í•¨ìˆ˜ ì„ íƒ
5. **Logs** í™•ì¸

**ì°¾ì•„ì•¼ í•  ë¡œê·¸**:
```
Clock in attempt - userId: X, date: YYYY-MM-DD, time: HH:mm:ss
Clock in success - shiftId: X, userId: X
```

### Supabase ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸

1. Supabase ëŒ€ì‹œë³´ë“œ ì ‘ì†
2. **Table Editor** > `shifts` í…Œì´ë¸”
3. ìµœê·¼ ë ˆì½”ë“œ í™•ì¸:
   - `date`: YYYY-MM-DD í˜•ì‹
   - `start_time`: HH:mm:ss í˜•ì‹
   - `end_time`: HH:mm:ss í˜•ì‹
   - `work_hours`: ìˆ«ì (ì†Œìˆ˜ì  í¬í•¨)

---

## ğŸš¨ ë¬¸ì œ ë°œìƒ ì‹œ ëŒ€ì‘

### ì—¬ì „íˆ ì €ì¥ë˜ì§€ ì•ŠëŠ” ê²½ìš°

1. **Vercel ë¡œê·¸ í™•ì¸**
   - ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸
   - ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë¶„ì„

2. **í™˜ê²½ ë³€ìˆ˜ í™•ì¸**
   ```
   DATABASE_URL=postgresql://...
   ```
   - Vercel ì„¤ì •ì—ì„œ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸

3. **ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í…ŒìŠ¤íŠ¸**
   - Supabaseì—ì„œ ì§ì ‘ ì¿¼ë¦¬ ì‹¤í–‰
   - ì—°ê²° ë¬¸ìì—´ ìœ íš¨ì„± í™•ì¸

4. **ë¸Œë¼ìš°ì € ì½˜ì†” í™•ì¸**
   - F12 ê°œë°œì ë„êµ¬
   - Console íƒ­ì—ì„œ ì—ëŸ¬ í™•ì¸
   - Network íƒ­ì—ì„œ API ìš”ì²­/ì‘ë‹µ í™•ì¸

---

## ğŸ“ ë³€ê²½ëœ íŒŒì¼ ëª©ë¡

1. `/api/index.js`
   - `getCurrentTimeKST()` í•¨ìˆ˜ ì¶”ê°€
   - `calculateWorkHours()` í•¨ìˆ˜ ê°œì„ 
   - ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í’€ ì„¤ì • ë³€ê²½
   - ì¶œí‡´ê·¼ API ì—”ë“œí¬ì¸íŠ¸ ë¡œê¹… ê°•í™”

2. `/client/src/App.jsx`
   - `handleClockIn()` í•¨ìˆ˜ ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ 
   - `handleClockOut()` í•¨ìˆ˜ ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ 
   - `loadShifts()` í•¨ìˆ˜ ë¡œê¹… ì¶”ê°€

---

## âœ… ì˜ˆìƒ ê²°ê³¼

ì´ ìˆ˜ì •ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ê°œì„ ì´ ì˜ˆìƒë©ë‹ˆë‹¤:

1. **ì•ˆì •ì„±**: ëª¨ë“  í™˜ê²½ì—ì„œ ì¼ê´€ëœ ë™ì‘
2. **ì„±ëŠ¥**: ë™ì‹œ ì ‘ì† ì²˜ë¦¬ ëŠ¥ë ¥ í–¥ìƒ
3. **ë””ë²„ê¹…**: ë¬¸ì œ ë°œìƒ ì‹œ ë¹ ë¥¸ ì›ì¸ íŒŒì•…
4. **ì‚¬ìš©ì ê²½í—˜**: ëª…í™•í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ ì œê³µ

---

## ğŸ”„ ë‹¤ìŒ ë‹¨ê³„

1. **ì¦‰ì‹œ**: ì½”ë“œ ì»¤ë°‹ ë° Vercel ë°°í¬
2. **ë°°í¬ í›„**: ì‹¤ì œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸
3. **1ì£¼ì¼ í›„**: ë¡œê·¸ ë¶„ì„ ë° ì¶”ê°€ ê°œì„ ì‚¬í•­ íŒŒì•…
4. **í•„ìš”ì‹œ**: ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ìŠ¤ ìµœì í™” ê³ ë ¤
